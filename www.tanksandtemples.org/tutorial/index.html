

<html lang="en">


<!-- Mirrored from www.tanksandtemples.org/tutorial/ by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 24 May 2021 11:52:14 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>


    <link rel="shortcut icon" type="image/x-icon" href="../static/websites/modern-business/images/temple_gray2.ico">
<!--    <link rel="icon" type="image/png" href="favicon.png" />-->
<!--    <link rel="shortcut icon" type="image/png" href="/static/websites/modern-business/images/temple_gray2.png">-->

    
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="">

    <title>Tanks and Temples Benchmark</title>
    <!-- Bootstrap Core CSS -->
    
    <link href="../static/websites/modern-business/css/bootstrap.min.css" rel="stylesheet" media="screen">
    

    <!-- Custom CSS -->
    
    <link href="../static/websites/modern-business/css/modern-business.css" rel="stylesheet" media="screen">
    
    <!-- Custom Fonts -->
    
<!--    <link href="/static/modern-business/font-awesome/css/font-awesome.min.css" rel="stylesheet" media="screen">-->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet"/>

    <link href="../static/websites/modern-business/css/custom.css" rel="stylesheet" media="screen">
    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->
    
    
    
    

    
    


<style>
h3{
	padding: 0px;
	margin: 0px;
	display:inline;
	border:0;
}
hr{
	padding: 10px;
	margin: 5px;
}
</style>


<script type="text/javascript" async
src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML">
</script>



    

<!--
<script type="text/javascript" src="/static/websites/tablesorter/jquery-latest.js"></script> 
<script type="text/javascript" src="/static/websites/tablesorter/jquery.tablesorter.js"></script> 
-->
<!--
<script src="http://tablesorter.com/jquery-latest.js" type="text/javascript"></script> 
<script src="http://tablesorter.com/jquery.tablesorter.min.js" type="text/javascript"> </script>    
-->
<!--<script src="js/bootstrap.min.js"></script>-->


    
    

  
 
    
    
</head>

<body>
    
    

    <!-- Navigation -->
    <nav class="navbar navbar-inverse navbar-custom navbar-fixed-top" role="navigation">
        <div class="container">
            <!-- Brand and toggle get grouped for better mobile display -->
            <div class="navbar-header">
                <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <a class="navbar-brand " href="../index.html">Tanks and Temples</a>
            </div>
            <!-- Collect the nav links, forms, and other content for toggling -->
            <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
                <ul class="nav navbar-nav navbar-right" >
                  
<!--
                    <li>
                        <a href="/"style="font-family:verdana;font-size: 18px; color: #777; ">Home</a>
                    </li>
-->
                    <li>
                        <a href="../index.html" >Home</a>
                    </li>
                    <li>
                        <a href="../download/index.html">Download</a>
                    </li>
                    <li>
                        <a href="../submit/index.html">Submit</a>
                    </li>
                    <li>
                        <a href="../leaderboard/index.html">Leaderboard</a>
                    </li>
                    <li>
                        <a href="index.html">Tutorial</a>
                    </li>
                    <li>
                        <a href="../license/index.html">License</a>
                    </li>
                    <li>
                        <a href="../contact/index.html">Contact</a>
                    </li>
            
                     
                    <li class="dropdown">
	          <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false"><i class="fa  fa-1.5x fa-unlock"></i> <span class="caret"></span></a>
	          <ul class="dropdown-menu" role="menu">
	            <li><a href="../signmeup/index.html">Sign me up</a></li>
                <li><a href="../reset/index.html">Forgot my password</a></li>
	            <li class="divider"></li>
	            <li><a href="../login/index.html">Login</a></li>
	          </ul>
	        </li>
                    
                    
                    
                </ul>
            </div>
            <!-- /.navbar-collapse -->
            
            
            
        </div>
        <!-- /.container -->
    </nav>

    
    
    
    

    
    
    <header class="container" style="margin-top: 15px;">
        <div class="jumbotron" style="height:200px; text-shadow: 0px 3px 4px #555; background:url(../static/websites/modern-business/images/family2.png)no-repeat 100% center, linear-gradient(125deg,white, #444444);background-size: auto 100%;"> 
<!--            #box-shadow: 0 6px 20px -7px black;">-->
            
                        <h1  style="font-size: 320%">Tutorial</h1>
                    
        
        </div>              
    </header>
    
    
        <div class="container">







            
            
           
            

        


<!-- Marketing Icons Section -->
<div class="row">


	<!--            <div class="section col-md-12 text-center">-->

	<!--                <div id="left" style="width:300px; height:100px; float:left; margin:5px 40px 0;">-->
	<div class="col-md-12">

		<p>
			The following tutorial shows how to make a reconstruction and get a evaluation result. This tutorial uses <a href="https://colmap.github.io/index.html" target="_blank">COLMAP</a> and Ignatius dataset for quick start.
		</p>

		<br>

		<h3>1. Prepare Images</h3><hr>
		<!--                <p>For both groups we provide high resolution videos and pre-sampled image sets to work with.<br></p>-->

		<p>
			Download the <a href="https://storage.googleapis.com/t2-downloads/image_sets/Ignatius.zip" download>image set</a> or the <a href="https://storage.googleapis.com/t2-downloads/videos/Ignatius.mp4" download>video</a> of Ignatius dataset from the <a href="../download/index.html" > download page</a>. For the image set, unzip the package and go to step 2. For the video, use the following script to sample key frames from the video (These tools are required: <i><b>ffmpeg</i></b>, <i><b>mogrify</i></b>and <i><b>exiftool</i></b>):
		</p>
		<pre>
<b>Get jpg images from the video:</b>
> ffmpeg -i Ignatius.mp4 -q:v 1 -vf fps=1 Ignatius/%06d.jpg

<b>Resize:</b>
> mogrify -quality 100 -resize 50% -path Ignatius2/ Ignatius/*.jpg

<b>Write EXIF data:</b>
> exiftool -overwrite_original -FocalLength="21" -focallengthin35mmformat="21" -make="Sony" -model="A7SM2" Ignatius2/*.jpg
		</pre>

		<br>
		<br>
		<h3>2. Make a Reconstruction</h3><hr>

		<p>
			Download and install <a href="https://colmap.github.io/index.html" target="_blank">COLMAP</a>. Follow the <a href="https://colmap.github.io/install.html" target="_blank">installation guidelines</a> and the COLMAP <a href="https://colmap.github.io/tutorial.html" target="_blank">tutorial</a> to make a reconstruction of our Ignatius2 image set obtained from step 1. Alternatively, you can run <a href="https://raw.githubusercontent.com/IntelVCL/TanksAndTemples/master/python_toolbox/get_colmap_reconstruction.sh" download>this script</a> which includes all necessary steps of the COLMAP pipeline to produce a reconstruction:
		</p>

		<pre>
> sh get_colmap_reconstruction.sh [COLMAP-exe-directory] [image-set-directory] [project-directory]
		</pre>
		<!--
		<b>Example:</b>
		> sh get_colmap_reconstruction.sh software/colmap/build/src/exe/ Ignatius2/ Ignatius_COLMAP/
	-->
		<p>
			After a successful run, the reconstruction "fused.ply" can be found in the [project-directory]/dense folder. The next step is jumping to Appendix A to prepare a *.log file to prepare evaluation.
		</p>

		<br>
		<br>
		<h3>3. Evaluation</h3><hr>
	<p>

	</p>

	<p> This tutorial uses Ignatius, one of the <b>training</b> datasets. Please follow step 3-1 to perform an offline evaluation for Ignatius. If you are working on a <b>testing</b> dataset and considering submission, please jump to step 3-2. For more details regarding evaluation metric, see Appendix B.
	</p>

	<br>
	<h4>3-1. Offline evaluation for <b>training</b> set</h4><hr>

	<p>
		The reconstruction of training set can be evaluated using public ground truth. Since the SfM reconstruction has arbitrary scale and orientation, it is necessary to exactly align the reconstruction with the ground truth. This can be done automatically by using <a href="http://open3d.org/" target="_blank">Open3D</a> and <a href="https://github.com/IntelVCL/TanksAndTemples/tree/master/python_toolbox/evaluation" target="_blank">our evaluation script</a>. To install Open3D, please follow <a href="http://open3d.org/docs/tutorial/Advanced/interactive_visualization.html#manual-registration" target="_blank">this instruction</a>. To use our evaluation script, clone <a href="https://github.com/IntelVCL/TanksAndTemples" target="_blank">TanksAndTemples github repository</a> and follow the instructions shown in <a href="https://github.com/IntelVCL/TanksAndTemples/blob/master/python_toolbox/evaluation/README.md" target="_blank">our evaluation README</a>. You can download the <a href="https://storage.googleapis.com/t2-training-gt-data/Ignatius/Ignatius.ply" download>Ignatius ground-truth file</a> as a reference.
	</p>
	<p>
		The followings are evaluation results:
	</p>
	<div class="container">
		<div class="col-md-6 text-center">
			<img src="../static/websites/modern-business/images/tutorial_fscore.jpg" class="img-responsive">
			precision and recall curve with F-score
		</div>
		<div class="col-md-3 text-center">
			<img src="../static/websites/modern-business/images/tutorial_precision.jpg" class="img-responsive">
			precision
		</div>
		<div class="col-md-3 text-center">
			<img src="../static/websites/modern-business/images/tutorial_recall.jpg" class="img-responsive">
			recall
		</div>
	</div>
	<p>
		Alternatively, <a href="https://sourceforge.net/projects/meshlab/" target="_blank">MeshLab</a> or <a href="http://www.danielgm.net/cc/" target="_blank">CloudCompare cab be used</a> for evaluation too. Make sure you set the ground-truth file as a reference, and align the reconstruction to it.
	</p>

	<br>
	<h4>3-2. Online evaluation for <b>testing</b> set</h4><hr>

	<p>
		This case uses a dedicated server for the evaluation. It is based on the same evaluation pipeline used for the offline case, but the ground truth geometries are not public. Instead, the result can be posted on the <a href="../leaderboard/index.html">leaderboard</a>. Please go to the <a href="../submit/index.html" > submission page</a> and follow the instruction. Note that models in either the intermediate or the advanced set need to be reconstructed for submission.
	</p>


	<br>
	<br>
	<h3>Appendix A. Convert SfM files into log format</h3><hr>

	<p>

		For an evaluation, the camera poses need to be stored in <a href="http://redwood-data.org/indoor/fileformat.html" target="_blank">*.log</a> format. An example of a log file can be seen <a href="https://raw.githubusercontent.com/IntelVCL/TanksAndTemples/master/test_data/test.log" target="_blank">here</a>. Every input image needs to have an entry in the log file, regardless if it is recognized as a valid view in the SfM bundle or not. <b>It is okay to have some inaccurate camera poses.</b> The back-end of our evaluation server is robust to such cases. However, we do recommend to estimate the camera pose as good as possible.

		To convert the COLMAP SfM data to the log format you can use <a href="https://raw.githubusercontent.com/IntelVCL/TanksAndTemples/master/python_toolbox/convert_to_logfile.py" download>this python script</a> and follow the instructions below. The script can also be used to convert MVE or VisualSfM SfM data.

		<br><br><p><h4>Case 1: Reconstruction from an image set</h4></p>

		If you used the pre-sampled image set provide on our download page, you only need to run the following script to convert the SfM data into our log file format:
		<br>&nbsp<br>
		<pre>
> python convert_to_logfile.py [COLMAP SfM file] [output log-filename] [folder of the input images] [COLMAP/MVE/VSFM] [image format]

<b>Example to get the *.log file of the COLMAP reconstruction of this tutorial:</b>
> python convert_to_logfile.py Ignatius_COLMAP/sparse/0/ cameras.log Ignatius_COLMAP COLMAP jpg

<b>Example to get the *.log file of a MVE based SfM file:</b>
> python convert_to_logfile.py mve-folder/synth_0.out mve.log mve_test/views/ MVE

<b>Example to get the *.log file of a VisualSfM based SfM file:</b>
> python convert_to_logfile.py vsfm-folder/result.nvm vsfm_log.log vsfm_test/ input_images/ VSFM jpg
		</pre>

		<p>
			If you convert COLMAP SfM data you will need the COLMAP <a href="https://raw.githubusercontent.com/colmap/colmap/master/scripts/python/read_model.py" download>read_model.py</a> script in the same folder you are executing the <a href="https://raw.githubusercontent.com/IntelVCL/TanksAndTemples/master/python_toolbox/convert_to_logfile.py" download>this script</a> from.

		</p>
		<br><p><h4>Case 2: Reconstruction from a video</h4></p>

		<p>
			If you used the video and sampled your own set of images, it is important to submit a log file which includes interpolated camera poses for all the individual frames of the video. First, create a log file (cameras.log) using the script in Case 1. Then edit a mapping.txt file that includes information about which video frames you sampled. For this tutorial example it would look like the following:
		</p>



		<pre>
[number of input camera poses]
[number of frames in the video]
[Image ID] [video frame ID] : (repeat for every image)

<b>Example mapping file of this tutorial: </b>
263
7845
0 1
1 31
2 61
3 91
4 121
...
		</pre>
		<p>
			Make sure that there are no empty lines in the mapping file. The full mapping file for this tutorial can be downloaded <a href="https://raw.githubusercontent.com/IntelVCL/TanksAndTemples/master/test_data/Ignatius_mapping.txt" download>here</a>. Using the log file interpolation function from our <a href="https://github.com/IntelVCL/TanksAndTemples" target="_blank">toolbox</a> you can now generate a log file (Ignatius.log) which includes interpolated camera poses for every frame:


		</p>



		<pre>
> python TanksAndTemples/python_toolbox/interpolate_log_file.py cameras.log Ignatius_mapping.txt Ignatius.log
		</pre>

		<p>
			If Ignatius would be part of our test set, you could just take the Ignatius.log file and rename the reconstruction to "Ignatius.ply" and do this for all other reconstructions of the advanced or intermediate set, and you would be ready to make a submission. Check the <a href="../submit/index.html" > Submit</a> section of this site for further details on how to proceed with a test set submission.
		</p>


		<br>
		<br>
		<h3>Appendix B. Compute F-score</h3><hr>

		<p>
			<a href="https://github.com/IntelVCL/TanksAndTemples/tree/master/python_toolbox/evaluation" target="_blank">Our evaluation</a> computes F-score using the following equations.
			Let \( \mathcal{G} \) be the ground truth and \( \mathcal{R} \) a reconstructed point set being evaluated. For a reconstructed point \( \mathbf{r} \in \mathcal{R} \), its distance to the ground truth is defined as:
			\begin{equation}
			e_{\mathbf{r} \to \mathcal{G}} = \min_{\mathbf{g} \in \mathcal{G}} |\mathbf{r} - \mathbf{g}| .
			\end{equation}
			These distances can be aggregated to define the precision of the reconstruction \( \mathcal{R}\) for any distance threshold \( d \):
			\begin{equation}
			P(d) = \frac{100}{|\mathcal{R}|} \sum_{\mathbf{r} \in \mathcal{R}} \big[ e_{\mathbf{r} \to \mathcal{G}} < d \big]
			\label{eq:precision}
			\end{equation}
			where \( [\cdot]\) is the Iverson bracket. \( P(d) \) is defined to lie in the range [0,100] and can be interpreted as a percentage.

			Similarly, for a ground-truth point \( \mathbf{g} \in \mathcal{G} \), its distance to the reconstruction is defined as
			\begin{equation}
			e_{\mathbf{g} \to \mathcal{R}} = \min_{\mathbf{r} \in \mathcal{R}} |\mathbf{g} - \mathbf{r}| .
			\end{equation}
			The recall of the reconstruction \( \mathcal{R}\) for a distance threshold \( d \) is defined as
			\begin{equation}
			R(d) = \frac{100}{|\mathcal{G}|} \sum_{\mathbf{g} \in \mathcal{G}} \big[ e_{\mathbf{g} \to \mathcal{R}} < d \big].
			\label{eq:recall}
			\end{equation}

			Precision and recall can be combined in a summary measure, the F-score:
			\begin{equation}
			F(d) = \frac{2P(d)R(d)}{P(d)+R(d)}.
			\label{eq:f-score}
			\end{equation}
			The F-score at a given threshold \( d \) is the harmonic mean of precision and recall at this threshold. It has the property that if either \( {P(d)\rightarrow 0}\) or \( {R(d)\rightarrow 0}\), then \( {F(d)\rightarrow 0}\). It is thus a better summary measure than the arithmetic mean, which does not have this property.


		</p>
		<br><br><br>

	</div>




</div>
<!-- /.row -->








            
        <!-- Footer -->
        <footer>
            <div class="row">
                <div class="text-center col-lg-12">
                    <p>&copy;  2017 | tanksandtemples.org</p>
                </div>
            </div>
        </footer>

    </div>
    
    <!-- jQuery -->
    

    
    


    
    <script src="../static/websites/modern-business/js/jquery.js"></script>
    
    
    <!-- Bootstrap Core JavaScript -->
    
    <script src="../static/websites/modern-business/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="../static/websites/modern-business/js/bootstrap-filestyle.min.js"></script>
    
    
    
    
    
    <!-- Script to Activate the Carousel -->
    <script>
    $('.carousel').carousel({
        interval: 15000 //changes the speed
    })
   
    </script>
    
<!--    Supposed to store Tab-positions-->
<!--
    <script>
     
    </script>
-->
                 


    


         

</body>


<!-- Mirrored from www.tanksandtemples.org/tutorial/ by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 24 May 2021 11:52:21 GMT -->
</html>
